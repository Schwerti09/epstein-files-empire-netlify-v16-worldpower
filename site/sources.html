<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sources – Epstein Files</title>
  <meta name="description" content="Quellen‑Index: Alle Treffer führen auf Originalquellen.">
  <meta property="og:title" content="Sources – Epstein Files">
  <meta property="og:description" content="Quellen‑Index: Alle Treffer führen auf Originalquellen.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/sources.html">
  <meta property="og:image" content="/.netlify/functions/og?title=Sources%20–%20Epstein%20Files&subtitle=INDEX%20%E2%80%A2%20PROGRAMMATIC">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="stylesheet" href="/styles.css">
  <link rel="icon" href="/assets/favicon.svg">
</head>
<body>

<div class="topbar">
  <div class="container">
    <div class="row">
      <div class="badge"><span class="dot"></span><strong>Live</strong> · <span id="today"></span></div>
      <div class="badge">
        <span class="muted">Keine Volltexte. Nur Quellenlinks + Zusammenfassungen.</span>
        <span class="sep">·</span>
        Status: <span id="authState">Gast</span> · <a href="#" id="logoutBtn" style="display:none">Logout</a>
      </div>
    </div>
  </div>
</div>

<header class="masthead">
  <div class="container">
    <div class="inner">
      <div class="logo">
        EPSTEIN FILES
        <small>Index + Leseführung für öffentlich zugängliche Quellen · Premium: Highlights, Smart‑Match, Namen‑Index</small>
      </div>
      <div class="actions">
        <a class="btn" href="/search.html">Suche</a>
        <a class="btn" href="/names.html">Namen‑Index</a>
        <a class="btn primary" href="#" data-subscribe>Premium freischalten <small>ab €1,99</small></a>
      </div>
    </div>
  </div>
</header>

<nav class="nav" aria-label="Hauptnavigation">
  <div class="container">
    <div class="row">
      <a href="/">Start</a>
      <a href="/search.html">Suche</a>
      <a href="/names.html">Namen‑Index</a>
      <a href="/topics.html">Topics</a>
      <a href="/sources.html">Sources</a>
      <a href="/timeline.html">Timeline</a>
      <a href="/alerts.html">Alerts</a>
      <a href="/pricing.html">Preise</a>
      <a href="/newsletter.html">Briefing</a>
      <a href="/account.html">Account</a>
      <a href="/about.html">Methode</a>
      <a href="/partners.html">Partner</a>
    </div>
  </div>
</nav>

<main class="container">
  <section class="card pad" style="margin-top:16px">
    <div class="kicker">Sources</div>
    <h1 class="h1" style="margin-top:6px">Quellen‑Index</h1>
    <p class="p muted">Alle Treffer führen auf Originalquellen. Wir hosten keine Volltexte.</p>
    <div class="searchbar">
      <input id="sourceSearch" placeholder="Quelle filtern… (z.B. court, docket, newspaper)" />
      <a class="btn" href="/search.html">Zur Suche</a>
      <a class="btn primary" href="#" data-subscribe>Premium</a>
    </div>
  </section>

  <section class="card" style="margin-top:14px">
    <div class="pad" style="border-bottom:1px solid var(--line)">
      <div class="kicker">Index</div>
      <div class="h2">Top Sources</div>
      <div class="p small muted">Aus den letzten 12 Monaten. Klick öffnet Source‑Landingpage.</div>
    </div>
    <div class="list" id="sourcesList"></div>
  </section>
</main>

<script type="module">
  import { apiGet, esc, fmtDate } from "/js/api.js";
  const listEl = document.getElementById("sourcesList");
  const inp = document.getElementById("sourceSearch");
  let rows = [];
  function render(filter="") {
    const f = (filter||"").trim().toLowerCase();
    const shown = rows.filter(r => String(r.source_name||"").toLowerCase().includes(f)).slice(0, 400);
    listEl.innerHTML = shown.map(r => {
      const n = String(r.source_name||"").trim();
      const c = r.count || 0;
      const last = r.last_seen ? fmtDate(r.last_seen) : "";
      return `<div class="item">
        <div class="title"><a href="/source/${encodeURIComponent(n)}">${esc(n)}</a></div>
        <div class="meta"><span class="muted">${c} Treffer</span>${last?`<span>·</span><span class="muted">zuletzt: ${esc(last)}</span>`:""}</div>
      </div>`;
    }).join("") || `<div class="pad"><div class="muted">Keine Sources gefunden.</div></div>`;
  }
  async function load() {
    listEl.innerHTML = `<div class="pad"><div class="muted">Lade…</div></div>`;
    try {
      const out = await apiGet("/api/source-stats?limit=300&days=365");
      rows = out?.data || [];
      render("");
    } catch (e) {
      listEl.innerHTML = `<div class="pad"><div class="muted">Sources nicht verfügbar.</div></div>`;
    }
  }
  inp?.addEventListener("input", () => render(inp.value));
  load();
</script>

<div class="footer">
  <div class="container">
    <div class="row">
      <div>© <span id="yearNow"></span> Wissens‑Bank.</div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <a href="/impressum.html">Impressum</a>
        <a href="/datenschutz.html">Datenschutz</a>
        <a href="/agb.html">AGB</a>
      </div>
    </div>
    <div style="margin-top:10px" class="p small muted">
      Hinweis: Wir hosten keine urheberrechtlich geschützten Inhalte Dritter. Wir verlinken auf Quellen und erstellen Zusammenfassungen/Leseführung.
    </div>
  </div>
</div>

<script type="module">
  import { apiPost, getToken, clearToken } from "/js/api.js";
  const d = new Date();
  document.getElementById("today").textContent = d.toLocaleDateString("de-DE", { weekday:"long", year:"numeric", month:"long", day:"2-digit" });
  document.getElementById("yearNow").textContent = d.getFullYear();
  const t = getToken();
  const st = document.getElementById("authState");
  const lo = document.getElementById("logoutBtn");
  if (st) st.textContent = t ? "Premium aktiv" : "Gast";
  if (lo) {
    lo.style.display = t ? "inline-flex" : "none";
    lo.addEventListener("click", (e)=>{ e.preventDefault(); clearToken(); location.reload(); });
  }
  document.querySelectorAll("[data-subscribe]").forEach(btn=>{
    btn.addEventListener("click", async (e)=>{
      e.preventDefault();
      const old = btn.textContent;
      btn.textContent = "Weiterleitung…";
      const out = await apiPost("/api/checkout", {});
      if (out?.url) location.href = out.url;
      else { alert(out?.error || "Checkout fehlgeschlagen"); btn.textContent = old; }
    });
  });
</script>


<!-- Deployed with Zip-Ship -->
<div id="zipship-badge" style="position:fixed;bottom:12px;right:12px;z-index:9999;font-family:system-ui,sans-serif;font-size:12px;">
  <a href="https://zip-ship-revolution.com/?utm_source=user_site" target="_blank" rel="noopener" 
     style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(10,14,39,0.85);color:#00F0FF;text-decoration:none;border-radius:6px;border:1px solid rgba(0,240,255,0.3);backdrop-filter:blur(8px);transition:all 0.2s;">
    <span style="font-size:14px;">⚡</span>
    <span>Deployed with Zip-Ship</span>
  </a>
</div>
</body>
</html>
